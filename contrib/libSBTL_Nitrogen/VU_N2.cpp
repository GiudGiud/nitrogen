///////////////////////////////////////////////////////////////////////////
// LibSBTL_vu_N2 - SBTL library for gaseous nitrogen based on:
//
// Span, R., Lemmon, E.W., Jacobsen, R.T, Wagner, W., and Yokozeki, A.:
//
//   "A Reference Equation of State for the Thermodynamic Properties of Nitrogen for Temperatures from 63.151 to 1000 K and Pressures to 2200 MPa,"
//   J. Phys. Chem. Ref. Data, 29(6):1361-1433, 2000.
//
// Lemmon, E.W. and Jacobsen, R.T.:
//
//   "Viscosity and Thermal Conductivity Equations for Nitrogen, Oxygen, Argon, and Air"
//   Int. J. Thermophys., 25:21-69, 2004.
//
// Copyright (C) Idaho National Laboratory.
// All rights reserved.
//
// Disclaimer:
// The Idaho National Laboratory (INL) uses its best efforts to deliver a high-quality software and to verify that the computed information is correct.
// However, INL makes no warranties to that effect, and INL shall not be liable for any damage that may result from errors or omissions in the software.
//
// Version: 0.9.0
//
// VU_N2.h
//
#include "math.h"
#include "SBTL_call_conv.h"
#include "SBTL_def.h"
//
extern const double x1_VUN2[];
extern const double x2_VUN2[];
extern const double x2_RS_VUN2[];
//
void IJ_VU_N2(double v, double u, unsigned int& i, unsigned int& j, double& dx1, double& dx2) throw()
{
    double x1t,x1f,x2f;

    static const double x1_sub_RS_0=-6.457330306892;
    static const double x1_sub_RS_1=-4.6144775232791;
    static const double ZS_1=-4.576894421172;
    static const double dist_x1_inv_0=53.721057308717;
    static const double dist_x1_inv_1=17.682987648657;
    static const double x2_sub_RS_0=71.314715577889;
    static const double dist_x2_inv_0=0.20420795635245;
//
// transformations
    x1t=log(v);
//
    if(x1t>ZS_1) {
        x1f=(x1t-ZS_1)*dist_x1_inv_1;
        i=IROUND(x1f)+100;
        if(i>298) i=298;
    } else if(x1t<x1_sub_RS_1) {
        x1f=(x1t-x1_sub_RS_0)*dist_x1_inv_0;
        if(x1f>0.) i=IROUND(x1f);
        else i=0;
    } else {
        i=99;
    }
//
    x2f=(u-x2_sub_RS_0)*dist_x2_inv_0;
    if(x2f>0.) {
        j=IROUND(x2f);
        if(j>199) j=199;
    } else j=0;
//
    dx1=x1t-x1_VUN2[i];
    dx2=u-x2_VUN2[j];
}
//
void IJ_VU_N2_T(double vt, double u, unsigned int& i, unsigned int& j, double& dx1, double& dx2) throw()
{
    double x1f,x2f;

    static const double x1_sub_RS_0=-6.457330306892;
    static const double x1_sub_RS_1=-4.6144775232791;
    static const double ZS_1=-4.576894421172;
    static const double dist_x1_inv_0=53.721057308717;
    static const double dist_x1_inv_1=17.682987648657;
    static const double x2_sub_RS_0=71.314715577889;
    static const double dist_x2_inv_0=0.20420795635245;
//
    if(vt>ZS_1) {
        x1f=(vt-ZS_1)*dist_x1_inv_1;
        i=IROUND(x1f)+100;
        if(i>298) i=298;
    } else if(vt<x1_sub_RS_1) {
        x1f=(vt-x1_sub_RS_0)*dist_x1_inv_0;
        if(x1f>0.) i=IROUND(x1f);
        else i=0;
    } else {
        i=99;
    }
//
    x2f=(u-x2_sub_RS_0)*dist_x2_inv_0;
    if(x2f>0.) {
        j=IROUND(x2f);
        if(j>199) j=199;
    } else j=0;
//
    dx1=vt-x1_VUN2[i];
    dx2=u-x2_VUN2[j];
}
//
const double x1_VUN2[299] = {
    -6.448022969601,-6.4294082950191,-6.4107936204371,-6.3921789458552,-6.3735642712732,-6.3549495966913,-6.3363349221093,-6.3177202475274,-6.2991055729454,-6.2804908983635,
    -6.2618762237815,-6.2432615491996,-6.2246468746176,-6.2060322000357,-6.1874175254537,-6.1688028508718,-6.1501881762898,-6.1315735017079,-6.112958827126,-6.094344152544,
    -6.0757294779621,-6.0571148033801,-6.0385001287982,-6.0198854542162,-6.0012707796343,-5.9826561050523,-5.9640414304704,-5.9454267558884,-5.9268120813065,-5.9081974067245,
    -5.8895827321426,-5.8709680575606,-5.8523533829787,-5.8337387083967,-5.8151240338148,-5.7965093592328,-5.7778946846509,-5.7592800100689,-5.740665335487,-5.722050660905,
    -5.7034359863231,-5.6848213117411,-5.6662066371592,-5.6475919625772,-5.6289772879953,-5.6103626134133,-5.5917479388314,-5.5731332642494,-5.5545185896675,-5.5359039150855,
    -5.5172892405036,-5.4986745659216,-5.4800598913397,-5.4614452167577,-5.4428305421758,-5.4242158675938,-5.4056011930119,-5.3869865184299,-5.368371843848,-5.349757169266,
    -5.3311424946841,-5.3125278201021,-5.2939131455202,-5.2752984709383,-5.2566837963563,-5.2380691217744,-5.2194544471924,-5.2008397726105,-5.1822250980285,-5.1636104234466,
    -5.1449957488646,-5.1263810742827,-5.1077663997007,-5.0891517251188,-5.0705370505368,-5.0519223759549,-5.0333077013729,-5.014693026791,-4.996078352209,-4.9774636776271,
    -4.9588490030451,-4.9402343284632,-4.9216196538812,-4.9030049792993,-4.8843903047173,-4.8657756301354,-4.8471609555534,-4.8285462809715,-4.8099316063895,-4.7913169318076,
    -4.7727022572256,-4.7540875826437,-4.7354729080617,-4.7168582334798,-4.6982435588978,-4.6796288843159,-4.6610142097339,-4.642399535152,-4.62378486057,-4.6051701859881,
    -4.5486186563558,-4.4920671267236,-4.4355155970913,-4.378964067459,-4.3224125378268,-4.2658610081945,-4.2093094785622,-4.15275794893,-4.0962064192977,-4.0396548896655,
    -3.9831033600332,-3.9265518304009,-3.8700003007687,-3.8134487711364,-3.7568972415041,-3.7003457118719,-3.6437941822396,-3.5872426526073,-3.5306911229751,-3.4741395933428,
    -3.4175880637106,-3.3610365340783,-3.304485004446,-3.2479334748138,-3.1913819451815,-3.1348304155492,-3.078278885917,-3.0217273562847,-2.9651758266524,-2.9086242970202,
    -2.8520727673879,-2.7955212377557,-2.7389697081234,-2.6824181784911,-2.6258666488589,-2.5693151192266,-2.5127635895943,-2.4562120599621,-2.3996605303298,-2.3431090006975,
    -2.2865574710653,-2.230005941433,-2.1734544118008,-2.1169028821685,-2.0603513525362,-2.003799822904,-1.9472482932717,-1.8906967636394,-1.8341452340072,-1.7775937043749,
    -1.7210421747426,-1.6644906451104,-1.6079391154781,-1.5513875858459,-1.4948360562136,-1.4382845265813,-1.3817329969491,-1.3251814673168,-1.2686299376845,-1.2120784080523,
    -1.15552687842,-1.0989753487877,-1.0424238191555,-0.98587228952322,-0.92932075989095,-0.87276923025869,-0.81621770062643,-0.75966617099416,-0.7031146413619,-0.64656311172963,
    -0.59001158209737,-0.53346005246511,-0.47690852283284,-0.42035699320058,-0.36380546356832,-0.30725393393605,-0.25070240430379,-0.19415087467153,-0.13759934503926,-8.1047815406998e-002,
    -2.4496285774735e-002,3.2055243857529e-002,8.8606773489793e-002,0.14515830312206,0.20170983275432,0.25826136238658,0.31481289201885,0.37136442165111,0.42791595128338,0.48446748091564,
    0.5410190105479,0.59757054018017,0.65412206981243,0.71067359944469,0.76722512907696,0.82377665870922,0.88032818834148,0.93687971797375,0.99343124760601,1.0499827772383,
    1.1065343068705,1.1630858365028,1.2196373661351,1.2761888957673,1.3327404253996,1.3892919550319,1.4458434846641,1.5023950142964,1.5589465439286,1.6154980735609,
    1.6720496031932,1.7286011328254,1.7851526624577,1.84170419209,1.8982557217222,1.9548072513545,2.0113587809868,2.067910310619,2.1244618402513,2.1810133698835,
    2.2375648995158,2.2941164291481,2.3506679587803,2.4072194884126,2.4637710180449,2.5203225476771,2.5768740773094,2.6334256069417,2.6899771365739,2.7465286662062,
    2.8030801958384,2.8596317254707,2.916183255103,2.9727347847352,3.0292863143675,3.0858378439998,3.142389373632,3.1989409032643,3.2554924328966,3.3120439625288,
    3.3685954921611,3.4251470217933,3.4816985514256,3.5382500810579,3.5948016106901,3.6513531403224,3.7079046699547,3.7644561995869,3.8210077292192,3.8775592588515,
    3.9341107884837,3.990662318116,4.0472138477482,4.1037653773805,4.1603169070128,4.216868436645,4.2734199662773,4.3299714959096,4.3865230255418,4.4430745551741,
    4.4996260848064,4.5561776144386,4.6127291440709,4.6692806737031,4.7258322033354,4.7823837329677,4.8389352625999,4.8954867922322,4.9520383218645,5.0085898514967,
    5.065141381129,5.1216929107613,5.1782444403935,5.2347959700258,5.291347499658,5.3478990292903,5.4044505589226,5.4610020885548,5.5175536181871,5.5741051478194,
    5.6306566774516,5.6872082070839,5.7437597367162,5.8003112663484,5.8568627959807,5.913414325613,5.9699658552452,6.0265173848775,6.0830689145097,6.139620444142,
    6.1961719737743,6.2527235034065,6.3092750330388,6.3658265626711,6.4223780923033,6.4789296219356,6.5354811515678,6.5920326812001,6.6485842108324
};
/*
const double x1_RS_VUN2[300] = {
    -6.457330306892,-6.4387156323101,-6.4201009577281,-6.4014862831462,-6.3828716085642,-6.3642569339823,-6.3456422594003,-6.3270275848184,-6.3084129102364,-6.2897982356545,
    -6.2711835610725,-6.2525688864906,-6.2339542119086,-6.2153395373267,-6.1967248627447,-6.1781101881628,-6.1594955135808,-6.1408808389989,-6.1222661644169,-6.103651489835,
    -6.085036815253,-6.0664221406711,-6.0478074660891,-6.0291927915072,-6.0105781169252,-5.9919634423433,-5.9733487677613,-5.9547340931794,-5.9361194185974,-5.9175047440155,
    -5.8988900694335,-5.8802753948516,-5.8616607202696,-5.8430460456877,-5.8244313711057,-5.8058166965238,-5.7872020219418,-5.7685873473599,-5.7499726727779,-5.731357998196,
    -5.712743323614,-5.6941286490321,-5.6755139744502,-5.6568992998682,-5.6382846252863,-5.6196699507043,-5.6010552761224,-5.5824406015404,-5.5638259269585,-5.5452112523765,
    -5.5265965777946,-5.5079819032126,-5.4893672286307,-5.4707525540487,-5.4521378794668,-5.4335232048848,-5.4149085303029,-5.3962938557209,-5.377679181139,-5.359064506557,
    -5.3404498319751,-5.3218351573931,-5.3032204828112,-5.2846058082292,-5.2659911336473,-5.2473764590653,-5.2287617844834,-5.2101471099014,-5.1915324353195,-5.1729177607375,
    -5.1543030861556,-5.1356884115736,-5.1170737369917,-5.0984590624097,-5.0798443878278,-5.0612297132458,-5.0426150386639,-5.0240003640819,-5.0053856895,-4.986771014918,
    -4.9681563403361,-4.9495416657541,-4.9309269911722,-4.9123123165902,-4.8936976420083,-4.8750829674263,-4.8564682928444,-4.8378536182625,-4.8192389436805,-4.8006242690986,
    -4.7820095945166,-4.7633949199347,-4.7447802453527,-4.7261655707708,-4.7075508961888,-4.6889362216069,-4.6703215470249,-4.651706872443,-4.633092197861,-4.6144775232791,
    -4.576894421172,-4.5203428915397,-4.4637913619074,-4.4072398322752,-4.3506883026429,-4.2941367730106,-4.2375852433784,-4.1810337137461,-4.1244821841138,-4.0679306544816,
    -4.0113791248493,-3.9548275952171,-3.8982760655848,-3.8417245359525,-3.7851730063203,-3.728621476688,-3.6720699470557,-3.6155184174235,-3.5589668877912,-3.5024153581589,
    -3.4458638285267,-3.3893122988944,-3.3327607692622,-3.2762092396299,-3.2196577099976,-3.1631061803654,-3.1065546507331,-3.0500031211008,-2.9934515914686,-2.9369000618363,
    -2.880348532204,-2.8237970025718,-2.7672454729395,-2.7106939433073,-2.654142413675,-2.5975908840427,-2.5410393544105,-2.4844878247782,-2.4279362951459,-2.3713847655137,
    -2.3148332358814,-2.2582817062491,-2.2017301766169,-2.1451786469846,-2.0886271173524,-2.0320755877201,-1.9755240580878,-1.9189725284556,-1.8624209988233,-1.805869469191,
    -1.7493179395588,-1.6927664099265,-1.6362148802942,-1.579663350662,-1.5231118210297,-1.4665602913975,-1.4100087617652,-1.3534572321329,-1.2969057025007,-1.2403541728684,
    -1.1838026432361,-1.1272511136039,-1.0706995839716,-1.0141480543393,-0.95759652470708,-0.90104499507482,-0.84449346544256,-0.78794193581029,-0.73139040617803,-0.67483887654577,
    -0.6182873469135,-0.56173581728124,-0.50518428764898,-0.44863275801671,-0.39208122838445,-0.33552969875218,-0.27897816911992,-0.22242663948766,-0.16587510985539,-0.10932358022313,
    -5.2772050590866e-002,3.7794790413974e-003,6.0331008673661e-002,0.11688253830592,0.17343406793819,0.22998559757045,0.28653712720272,0.34308865683498,0.39964018646724,0.45619171609951,
    0.51274324573177,0.56929477536403,0.6258463049963,0.68239783462856,0.73894936426082,0.79550089389309,0.85205242352535,0.90860395315762,0.96515548278988,1.0217070124221,
    1.0782585420544,1.1348100716867,1.1913616013189,1.2479131309512,1.3044646605835,1.3610161902157,1.417567719848,1.4741192494803,1.5306707791125,1.5872223087448,
    1.643773838377,1.7003253680093,1.7568768976416,1.8134284272738,1.8699799569061,1.9265314865384,1.9830830161706,2.0396345458029,2.0961860754352,2.1527376050674,
    2.2092891346997,2.2658406643319,2.3223921939642,2.3789437235965,2.4354952532287,2.492046782861,2.5485983124933,2.6051498421255,2.6617013717578,2.7182529013901,
    2.7748044310223,2.8313559606546,2.8879074902868,2.9444590199191,3.0010105495514,3.0575620791836,3.1141136088159,3.1706651384482,3.2272166680804,3.2837681977127,
    3.340319727345,3.3968712569772,3.4534227866095,3.5099743162417,3.566525845874,3.6230773755063,3.6796289051385,3.7361804347708,3.7927319644031,3.8492834940353,
    3.9058350236676,3.9623865532999,4.0189380829321,4.0754896125644,4.1320411421966,4.1885926718289,4.2451442014612,4.3016957310934,4.3582472607257,4.414798790358,
    4.4713503199902,4.5279018496225,4.5844533792548,4.641004908887,4.6975564385193,4.7541079681515,4.8106594977838,4.8672110274161,4.9237625570483,4.9803140866806,
    5.0368656163129,5.0934171459451,5.1499686755774,5.2065202052097,5.2630717348419,5.3196232644742,5.3761747941064,5.4327263237387,5.489277853371,5.5458293830032,
    5.6023809126355,5.6589324422678,5.7154839719,5.7720355015323,5.8285870311646,5.8851385607968,5.9416900904291,5.9982416200613,6.0547931496936,6.1113446793259,
    6.1678962089581,6.2244477385904,6.2809992682227,6.3375507978549,6.3941023274872,6.4506538571195,6.5072053867517,6.563756916384,6.6203084460162,6.6768599756485
};
*/
const double x2_VUN2[200] = {
    73.7632,78.660168844221,83.557137688442,88.454106532663,93.351075376884,98.248044221106,103.14501306533,108.04198190955,112.93895075377,117.83591959799,
    122.73288844221,127.62985728643,132.52682613065,137.42379497487,142.3207638191,147.21773266332,152.11470150754,157.01167035176,161.90863919598,166.8056080402,
    171.70257688442,176.59954572864,181.49651457286,186.39348341709,191.29045226131,196.18742110553,201.08438994975,205.98135879397,210.87832763819,215.77529648241,
    220.67226532663,225.56923417085,230.46620301508,235.3631718593,240.26014070352,245.15710954774,250.05407839196,254.95104723618,259.8480160804,264.74498492462,
    269.64195376884,274.53892261307,279.43589145729,284.33286030151,289.22982914573,294.12679798995,299.02376683417,303.92073567839,308.81770452261,313.71467336683,
    318.61164221106,323.50861105528,328.4055798995,333.30254874372,338.19951758794,343.09648643216,347.99345527638,352.8904241206,357.78739296482,362.68436180905,
    367.58133065327,372.47829949749,377.37526834171,382.27223718593,387.16920603015,392.06617487437,396.96314371859,401.86011256281,406.75708140704,411.65405025126,
    416.55101909548,421.4479879397,426.34495678392,431.24192562814,436.13889447236,441.03586331658,445.9328321608,450.82980100503,455.72676984925,460.62373869347,
    465.52070753769,470.41767638191,475.31464522613,480.21161407035,485.10858291457,490.00555175879,494.90252060302,499.79948944724,504.69645829146,509.59342713568,
    514.4903959799,519.38736482412,524.28433366834,529.18130251256,534.07827135678,538.97524020101,543.87220904523,548.76917788945,553.66614673367,558.56311557789,
    563.46008442211,568.35705326633,573.25402211055,578.15099095477,583.04795979899,587.94492864322,592.84189748744,597.73886633166,602.63583517588,607.5328040201,
    612.42977286432,617.32674170854,622.22371055276,627.12067939698,632.01764824121,636.91461708543,641.81158592965,646.70855477387,651.60552361809,656.50249246231,
    661.39946130653,666.29643015075,671.19339899497,676.0903678392,680.98733668342,685.88430552764,690.78127437186,695.67824321608,700.5752120603,705.47218090452,
    710.36914974874,715.26611859296,720.16308743719,725.06005628141,729.95702512563,734.85399396985,739.75096281407,744.64793165829,749.54490050251,754.44186934673,
    759.33883819095,764.23580703518,769.1327758794,774.02974472362,778.92671356784,783.82368241206,788.72065125628,793.6176201005,798.51458894472,803.41155778894,
    808.30852663317,813.20549547739,818.10246432161,822.99943316583,827.89640201005,832.79337085427,837.69033969849,842.58730854271,847.48427738693,852.38124623116,
    857.27821507538,862.1751839196,867.07215276382,871.96912160804,876.86609045226,881.76305929648,886.6600281407,891.55699698492,896.45396582915,901.35093467337,
    906.24790351759,911.14487236181,916.04184120603,920.93881005025,925.83577889447,930.73274773869,935.62971658291,940.52668542714,945.42365427136,950.32062311558,
    955.2175919598,960.11456080402,965.01152964824,969.90849849246,974.80546733668,979.7024361809,984.59940502513,989.49637386935,994.39334271357,999.29031155779,
    1004.187280402,1009.0842492462,1013.9812180905,1018.8781869347,1023.7751557789,1028.6721246231,1033.5690934673,1038.4660623116,1043.3630311558,1048.26
};
//
const double x2_RS_VUN2[201] = {
    71.314715577889,76.211684422111,81.108653266332,86.005622110553,90.902590954774,95.799559798995,100.69652864322,105.59349748744,110.49046633166,115.38743517588,
    120.2844040201,125.18137286432,130.07834170854,134.97531055276,139.87227939698,144.76924824121,149.66621708543,154.56318592965,159.46015477387,164.35712361809,
    169.25409246231,174.15106130653,179.04803015075,183.94499899497,188.8419678392,193.73893668342,198.63590552764,203.53287437186,208.42984321608,213.3268120603,
    218.22378090452,223.12074974874,228.01771859296,232.91468743719,237.81165628141,242.70862512563,247.60559396985,252.50256281407,257.39953165829,262.29650050251,
    267.19346934673,272.09043819095,276.98740703518,281.8843758794,286.78134472362,291.67831356784,296.57528241206,301.47225125628,306.3692201005,311.26618894472,
    316.16315778894,321.06012663317,325.95709547739,330.85406432161,335.75103316583,340.64800201005,345.54497085427,350.44193969849,355.33890854271,360.23587738693,
    365.13284623116,370.02981507538,374.9267839196,379.82375276382,384.72072160804,389.61769045226,394.51465929648,399.4116281407,404.30859698492,409.20556582915,
    414.10253467337,418.99950351759,423.89647236181,428.79344120603,433.69041005025,438.58737889447,443.48434773869,448.38131658291,453.27828542714,458.17525427136,
    463.07222311558,467.9691919598,472.86616080402,477.76312964824,482.66009849246,487.55706733668,492.4540361809,497.35100502513,502.24797386935,507.14494271357,
    512.04191155779,516.93888040201,521.83584924623,526.73281809045,531.62978693467,536.52675577889,541.42372462312,546.32069346734,551.21766231156,556.11463115578,
    561.0116,565.90856884422,570.80553768844,575.70250653266,580.59947537688,585.49644422111,590.39341306533,595.29038190955,600.18735075377,605.08431959799,
    609.98128844221,614.87825728643,619.77522613065,624.67219497487,629.5691638191,634.46613266332,639.36310150754,644.26007035176,649.15703919598,654.0540080402,
    658.95097688442,663.84794572864,668.74491457286,673.64188341709,678.53885226131,683.43582110553,688.33278994975,693.22975879397,698.12672763819,703.02369648241,
    707.92066532663,712.81763417085,717.71460301508,722.6115718593,727.50854070352,732.40550954774,737.30247839196,742.19944723618,747.0964160804,751.99338492462,
    756.89035376884,761.78732261307,766.68429145729,771.58126030151,776.47822914573,781.37519798995,786.27216683417,791.16913567839,796.06610452261,800.96307336683,
    805.86004221106,810.75701105528,815.6539798995,820.55094874372,825.44791758794,830.34488643216,835.24185527638,840.1388241206,845.03579296482,849.93276180905,
    854.82973065327,859.72669949749,864.62366834171,869.52063718593,874.41760603015,879.31457487437,884.21154371859,889.10851256281,894.00548140704,898.90245025126,
    903.79941909548,908.6963879397,913.59335678392,918.49032562814,923.38729447236,928.28426331658,933.1812321608,938.07820100503,942.97516984925,947.87213869347,
    952.76910753769,957.66607638191,962.56304522613,967.46001407035,972.35698291457,977.25395175879,982.15092060302,987.04788944724,991.94485829146,996.84182713568,
    1001.7387959799,1006.6357648241,1011.5327336683,1016.4297025126,1021.3266713568,1026.223640201,1031.1206090452,1036.0175778894,1040.9145467337,1045.8115155779,
    1050.7084844221
};
//